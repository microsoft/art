trigger:
  branches:
    include:
      - master
  paths:
    exclude:
      - '*.md'

pr:
  branches:
    include:
      - master
  paths:
    exclude:
      - '*.md'

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.6'
  displayName: Setting Python Version...
- script: pip install -r azureml/requirements.txt
  displayName: 'Installing dependencies...'
- task: DockerInstaller@0
  inputs:
    dockerVersion: '17.09.0-ce'
  displayName: Installing Docker...
- task: AzureCLI@2
  inputs:
    azureSubscription: 'MMLSpark Connection'
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: |
      pip install
      python3 azureml/deploy.py
  displayName: Deploying...
